{"version":3,"file":"bundle.umd.js","sources":["../../../../eagle-sdk/catchError.js","../../../../eagle-sdk/index.js"],"sourcesContent":["let formatError = errObj => {\n  let col = errObj.column || errObj.columnNumber // Safari Firefox 浏览器中才有的信息\n  let row = errObj.line || errObj.lineNumber // Safari Firefox   浏览器中才有的信息\n  let message = errObj.message\n  let name = errObj.name\n\n  let { stack } = errObj\n  if (stack) {\n    let matchUrl = stack.match(/https?:\\/\\/[^\\n]+/) // 匹配从http?s 开始到出现换行符的信息, 这个不仅包括报错的文件信息而且还包括了报错的行列信息\n    let urlFirstStack = matchUrl ? matchUrl[0] : ''\n    // 获取到报错的文件\n    let regUrlCheck = /https?:\\/\\/(\\S)*\\.js/\n\n    let resourceUrl = ''\n    if (regUrlCheck.test(urlFirstStack)) {\n      resourceUrl = urlFirstStack.match(regUrlCheck)[0]\n    }\n\n    let stackCol = null // 获取statck中的列信息\n    let stackRow = null // 获取statck中的行信息\n    let posStack = urlFirstStack.match(/:(\\d+):(\\d+)/) // // :行:列\n    if (posStack && posStack.length >= 3) {\n      ;[, stackCol, stackRow] = posStack\n    }\n\n    // TODO formatStack\n    return {\n      content: stack,\n      col: Number(col || stackCol),\n      row: Number(row || stackRow),\n      message,\n      name,\n      resourceUrl\n    }\n  }\n\n  return {\n    row,\n    col,\n    message,\n    name\n  }\n}\n\nlet frameError = async errObj => {\n  const result = await $.get(`http://localhost:3000/sourcemap?col=${errObj.col}&row=${errObj.row}`)\n  console.log(result)\n  return errObj\n}\n\nlet errorCatch = {\n  init: cb => {\n    let _originOnerror = window.onerror\n    window.onerror = (...arg) => {\n      let [errorMessage, scriptURI, lineNumber, columnNumber, errorObj] = arg\n      let errorInfo = formatError(errorObj)\n      // 如果是使用webpack打包的框架代码报错，在处理一次，这里暂时使用resourceUrl字段进行区分是否是框架代码报错\n      if (errorInfo.resourceUrl === 'http://localhost:3000/react-app/dist/main.bundle.js') {\n        errorInfo = frameError(errorInfo)\n      }\n\n      errorInfo._errorMessage = errorMessage\n      errorInfo._scriptURI = scriptURI\n      errorInfo._lineNumber = lineNumber\n      errorInfo._columnNumber = columnNumber\n      errorInfo.type = 'onerror'\n      cb(errorInfo)\n      _originOnerror && _originOnerror.apply(window, arg)\n    }\n\n    let _originOnunhandledrejection = window.onunhandledrejection\n    window.onunhandledrejection = (...arg) => {\n      let e = arg[0]\n      let reason = e.reason\n      cb({\n        type: e.type || 'unhandledrejection',\n        reason\n      })\n      _originOnunhandledrejection && _originOnunhandledrejection.apply(window, arg)\n    }\n  }\n}\n\nexport default errorCatch\n","// 通过分模块的方式， 可以使用需要的模块。 让sdk具有更好的可维护性。\nimport perf from './perf'\nimport resource from './resource'\nimport xhrHook from './xhrHook'\nimport catchError from './catchError'\n\n// perf.init(() => {\n//   console.log('perf监测启动')\n// })\n\n// resource.init(resourceData => {\n//   console.log('resource监测启动')\n//   console.log(resourceData)\n// })\n\n// xhrHook.init(data => {\n//   console.log(data)\n// })\n\ncatchError.init(data => {\n  console.log(data)\n  console.log('catchError is start')\n})\n\nconsole.log('hello world 123')\n"],"names":["formatError","col","errObj","column","columnNumber","row","line","lineNumber","message","name","stack","matchUrl","match","urlFirstStack","regUrlCheck","resourceUrl","test","stackCol","stackRow","posStack","length","Number","frameError","$","get","log","result","errorCatch","_originOnerror","window","onerror","arg","errorMessage","scriptURI","errorObj","errorInfo","_errorMessage","_scriptURI","_lineNumber","_columnNumber","type","apply","_originOnunhandledrejection","onunhandledrejection","e","reason","catchError","init","data","console"],"mappings":";;;;;;;;;;;;AAAA,IAAIA,cAAc,SAAdA,WAAc,SAAU;MACtBC,MAAMC,OAAOC,MAAP,IAAiBD,OAAOE,YAAlC,CAD0B;MAEtBC,MAAMH,OAAOI,IAAP,IAAeJ,OAAOK,UAAhC,CAF0B;MAGtBC,UAAUN,OAAOM,OAArB;MACIC,OAAOP,OAAOO,IAAlB;;MAEMC,KANoB,GAMVR,MANU,CAMpBQ,KANoB;;MAOtBA,KAAJ,EAAW;QACLC,WAAWD,MAAME,KAAN,CAAY,mBAAZ,CAAf,CADS;QAELC,gBAAgBF,WAAWA,SAAS,CAAT,CAAX,GAAyB,EAA7C;;QAEIG,cAAc,sBAAlB;;QAEIC,cAAc,EAAlB;QACID,YAAYE,IAAZ,CAAiBH,aAAjB,CAAJ,EAAqC;oBACrBA,cAAcD,KAAd,CAAoBE,WAApB,EAAiC,CAAjC,CAAd;;;QAGEG,WAAW,IAAf,CAXS;QAYLC,WAAW,IAAf,CAZS;QAaLC,WAAWN,cAAcD,KAAd,CAAoB,cAApB,CAAf,CAbS;QAcLO,YAAYA,SAASC,MAAT,IAAmB,CAAnC,EAAsC;;qCACVD,QADU;;cAAA;cAAA;;;;WAK/B;eACIT,KADJ;WAEAW,OAAOpB,OAAOgB,QAAd,CAFA;WAGAI,OAAOhB,OAAOa,QAAd,CAHA;sBAAA;gBAAA;;KAAP;;;SAUK;YAAA;YAAA;oBAAA;;GAAP;CApCF;;AA4CA,IAAII;qEAAa,iBAAMpB,MAAN;;;;;;;mBACMqB,EAAEC,GAAF,0CAA6CtB,OAAOD,GAApD,aAA+DC,OAAOG,GAAtE,CADN;;;kBAAA;;oBAEPoB,GAAR,CAAYC,MAAZ;6CACOxB,MAHQ;;;;;;;;GAAb;;;;;GAAJ;;AAMA,IAAIyB,aAAa;QACT,kBAAM;QACNC,iBAAiBC,OAAOC,OAA5B;WACOA,OAAP,GAAiB,YAAY;wCAARC,GAAQ;WAAA;;;UACtBC,YADsB,GACyCD,GADzC;UACRE,SADQ,GACyCF,GADzC;UACGxB,UADH,GACyCwB,GADzC;UACe3B,YADf,GACyC2B,GADzC;UAC6BG,QAD7B,GACyCH,GADzC;;UAEvBI,YAAYnC,YAAYkC,QAAZ,CAAhB;;UAEIC,UAAUpB,WAAV,KAA0B,qDAA9B,EAAqF;oBACvEO,WAAWa,SAAX,CAAZ;;;gBAGQC,aAAV,GAA0BJ,YAA1B;gBACUK,UAAV,GAAuBJ,SAAvB;gBACUK,WAAV,GAAwB/B,UAAxB;gBACUgC,aAAV,GAA0BnC,YAA1B;gBACUoC,IAAV,GAAiB,SAAjB;SACGL,SAAH;wBACkBP,eAAea,KAAf,CAAqBZ,MAArB,EAA6BE,GAA7B,CAAlB;KAdF;;QAiBIW,8BAA8Bb,OAAOc,oBAAzC;WACOA,oBAAP,GAA8B,YAAY;yCAARZ,GAAQ;WAAA;;;UACpCa,IAAIb,IAAI,CAAJ,CAAR;UACIc,SAASD,EAAEC,MAAf;SACG;cACKD,EAAEJ,IAAF,IAAU,oBADf;;OAAH;qCAI+BE,4BAA4BD,KAA5B,CAAkCZ,MAAlC,EAA0CE,GAA1C,CAA/B;KAPF;;CArBJ;;AClDA;AACA,AAkBAe,WAAWC,IAAX,CAAgB,gBAAQ;UACdtB,GAAR,CAAYuB,IAAZ;UACQvB,GAAR,CAAY,qBAAZ;CAFF;;AAKAwB,QAAQxB,GAAR,CAAY,iBAAZ;;;;"}